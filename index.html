<html>

<head>
  <title>Try ùúë-calculus!</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <script src="all.js"></script>
  <link rel="shortcut icon" href="https://www.yegor256.com/images/books/elegant-objects/cactus.png" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/yegor256/tacit@gh-pages/tacit-css.min.css" />
  <link rel="stylesheet" href="styles.css" type="text/css">
  <style>
    section {
      width: 100%;
    }

    .row {
      display: flex;
    }

    .column {
      flex: 50%;
    }

    .example {
      cursor: pointer;
    }

    #__textarea__ {
      border: 1px solid lightgray;
    }
  </style>
</head>

<body>
  <section>
    <header>
      <center>
        <a href="https://www.eolang.org">
          <img src="https://www.yegor256.com/images/books/elegant-objects/cactus.png"
            style="width: 64px; height: 64px" />
        </a>
      </center>
    </header>
    <div class="column">
      <div class="object">
        <p>
          <label class="selected_mode">
            Minimal
          </label>
          <label class="switch">
            <input type="checkbox" id="toggler" onchange="switch_mode()">
            <span class="slider round"></span>
          </label>
          <label class="selected_mode">
            Full
          </label>
          <label class="reference_line">
            <a href="https://www.eolang.org">ùúë-calculus</a> expression
            (<a id="__permalink__" href="#">permalink</a>)
          </label>
        </p>
      </div>
      <div class="row">
        <table>
          <tr>
            <td class="object">
              <div id="editor"></div>
            </td>
            <td>
              <div>
                <table class="rules">
                  <caption>
                    <b>Minimal œÜ Syntax</b>
                    <br>
                    Lezer grammar is available <a href="./codemirror/src/lezer.grammar">here</a>
                  </caption>
                  <tr>
                    <td>
                      t :=
                    </td>
                    <td>
                      (term)
                    </td>
                  </tr>
                  <tr>
                    <td>
                      &nbsp; &nbsp; t.a
                    </td>
                    <td>
                      (attribute)
                    </td>
                  </tr>
                  <tr>
                    <td>
                      &nbsp; | t‚ÇÅ(a -> t‚ÇÇ)
                    </td>
                    <td>
                      (application)
                    </td>
                  </tr>
                  <tr>
                    <td>
                      &nbsp; | [a‚ÇÅ -> ?, ‚Ä¶, a‚Çñ -> ?, a‚Çñ‚Çä‚ÇÅ -> t‚Çñ‚Çä‚ÇÅ, ‚Ä¶, a‚Çò -> t‚Çò]
                    </td>
                    <td>
                      (object)
                    </td>
                  </tr>
                  <tr>
                    <td>
                      &nbsp; | ^n
                    </td>
                    <td>
                      (locator)
                    </td>
                  </tr>
                  <tr>
                    <td>
                      a := ( [a-z]([a-z0-9] | '_' )* ) | '@'
                    </td>
                    <td>
                      (attribute name)
                    </td>
                  </tr>
                </table>
              </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="row">
        <div id="__app__"></div>
      </div>
    </div>
    <footer>
      <nav>
        <ul>
          <li>
            To discuss how ùúë-calculus works, join our
            <a href="https://t.me/polystat_org">Telegram group</a>
          </li>
        </ul>
        <ul>
          <li>
            <a href="https://github.com/polystat/try-phi/stargazers">
              <img src="https://img.shields.io/github/stars/polystat/try-phi.svg?style=flat-square"
                alt="github stars" />
            </a>
          </li>
        </ul>
      </nav>
    </footer>
  </section>
  <!-- load codemirror (cm) bundle and set it up in the editor div -->
  <script src="codemirror/docs/build/bundle.js"></script>
  <script>
    let view = app.view;
    /* extract query parameters from the URL */
    const params = new URLSearchParams(window.location.search);

    /* use default snippet if one is not set in the query parameters */
    //     snippet = 
    // `[
    //   point -> [x -> ?, y ->?, z -> ?],
    //   a -> ^0.point(x -> ^1.int2)(y -> ^1.int4)(z -> ^1.int1),
    //   b -> ^0.point(x -> ^1.int7)(y -> ^1.int12)(z -> ^1.int2),
    //   dist -> ^1.dist(point1 -> ^0.a)(point2 -> ^0.b)
    // ].dist.val`;

    snippet =
      `[
  price -> ^1.int_2,
  book -> [
    title -> ^2.title,
    price -> ?
  ],
  manga -> [
    manga_title -> ^2.str_publisher.add(str -> ^0.title),
    @ -> ^1.book
  ](price -> ^0.price),
  title -> ^0.manga.manga_title
].manga.price`

    // snippet = "[x -> ^0.y, y -> ^0.z, z -> [b -> ^0.c, c -> ?](c -> ^0)].x.b"
    if (params.has("snippet")) {
      snippet = decodeURIComponent(params.get("snippet"));
    };
    // set default snippet
    view.dispatch({
      changes: { from: 0, to: view.state.doc.length, insert: snippet }
    });

  </script>
</body>

</html>